<?xml version="1.0" encoding="UTF-8"?>
<!--
/*
* Copyright (C) 2015 STFC
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
* http://www.apache.org/licenses/LICENSE-2.0
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
-->


<RoleActionMappingRules     
    xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance'
    xmlns='http://goc.egi.eu/2015/03/spec1.0_r1'
    xsi:schemaLocation='http://goc.egi.eu/2015/03/spec1.0_r1 ./RoleActionMappingsSchema.xsd'> 

    

    <RoleActionMapping> 
        <TargetProject>EGI</TargetProject> 

        <!-- 
        Define the Role names and which of the owned entity types they apply to. 
        Note, role name and alias values must be unique (names have a DB unique constraint).  
        Aliases are used as a convenient shorthand to define the XML rules. 
        --> 
        <RoleNames over="Project">
            <Role alias="COD_STAFF">COD Staff</Role>
            <Role alias="COD_ADMIN">COD Administrator</Role>
            <Role alias="EGI_CSIRT_OFFICER">EGI CSIRT Officer</Role>
            <Role alias="COO">Chief Operations Officer</Role>
        </RoleNames>  


        <RoleNames over="Ngi">
            <Role alias="NGI_OPS_MAN">NGI Operations Manager</Role>
            <Role alias="NGI_OPS_DEP_MAN">NGI Operations Deputy Manager</Role>
            <Role alias="NGI_SEC_OFFICER">NGI Security Officer</Role>
            <Role alias="REG_STAFF_ROD">Regional Staff (ROD)</Role>
            <Role alias="REG_FIRST_LINE_SUPPORT">Regional First Line Support</Role>
        </RoleNames>

        <RoleNames over="Site"> 
            <Role alias="SITE_ADMIN">Site Administrator</Role>
            <Role alias="SITE_SECOFFICER">Site Security Officer</Role>
            <Role alias="SITE_OPS_DEP_MAN">Site Operations Deputy Manager</Role>
            <Role alias="SITE_OPS_MAN">Site Operations Manager</Role>
        </RoleNames> 

        <RoleNames over="ServiceGroup">
            <Role alias="SERVICE_GROUP_ADMIN">Service Group Administrator</Role>
        </RoleNames>


        <!--
        The listed Roles enable the Actions over the target object(s). 
        --> 

        <RoleMapping>
            <Roles>
                COD_STAFF,
                COD_ADMIN,
                EGI_CSIRT_OFFICER,
                COO
            </Roles>  
            <EnabledActions>
                <Actions>ACTION_EDIT_OBJECT,ACTION_GRANT_ROLE,ACTION_REJECT_ROLE,ACTION_REVOKE_ROLE</Actions> 
                <Target>Project</Target> 
            </EnabledActions>
            <EnabledActions>
                <Actions>ACTION_GRANT_ROLE,ACTION_REJECT_ROLE,ACTION_REVOKE_ROLE</Actions>
                <Target>Ngi</Target>
            </EnabledActions>
        </RoleMapping>

        <RoleMapping>
            <Roles>
                NGI_OPS_MAN,
                NGI_OPS_DEP_MAN,
                NGI_SEC_OFFICER,
                REG_STAFF_ROD,
                REG_FIRST_LINE_SUPPORT
            </Roles>
            <EnabledActions>
                <Actions>ACTION_EDIT_OBJECT</Actions>
                <Target>Ngi</Target>
            </EnabledActions>
        </RoleMapping>

        <RoleMapping>
            <Roles>
                NGI_OPS_MAN,
                NGI_OPS_DEP_MAN,
                NGI_SEC_OFFICER
            </Roles>
            <EnabledActions>
                <Actions>ACTION_NGI_ADD_SITE,ACTION_GRANT_ROLE,ACTION_REJECT_ROLE,ACTION_REVOKE_ROLE</Actions>
                <Target>Ngi</Target>
            </EnabledActions>
        </RoleMapping>

        <RoleMapping> 
            <Roles>
                SITE_ADMIN, 
                SITE_SECOFFICER, 
                SITE_OPS_DEP_MAN, 
                SITE_OPS_MAN
                REG_FIRST_LINE_SUPPORT, 
                REG_STAFF_ROD, 
                NGI_SEC_OFFICER, 
                NGI_OPS_DEP_MAN, 
                NGI_OPS_MAN 
            </Roles>  
            <EnabledActions> 
                <Actions>ACTION_EDIT_OBJECT, ACTION_SITE_ADD_SERVICE, ACTION_SITE_DELETE_SERVICE</Actions> 
                <Target>Site</Target>   
            </EnabledActions> 
        </RoleMapping> 


        <RoleMapping> 
            <Roles>
                SITE_SECOFFICER, 
                SITE_OPS_DEP_MAN, 
                SITE_OPS_MAN
                NGI_SEC_OFFICER, 
                NGI_OPS_DEP_MAN, 
                NGI_OPS_MAN 
            </Roles> 
            <EnabledActions> 
                <Actions>ACTION_GRANT_ROLE, ACTION_REJECT_ROLE, ACTION_REVOKE_ROLE</Actions> 
                <Target>Site</Target>   
            </EnabledActions> 
        </RoleMapping> 

 
        <RoleMapping> 
            <Roles>
                NGI_SEC_OFFICER, 
                NGI_OPS_DEP_MAN, 
                NGI_OPS_MAN  
                COD_STAFF,
                COD_ADMIN,
                EGI_CSIRT_OFFICER,
                COO
            </Roles>  
            <EnabledActions> 
                <Actions>ACTION_SITE_EDIT_CERT_STATUS</Actions> 
                <Target>Site</Target>   
            </EnabledActions> 
        </RoleMapping> 


        <RoleMapping>
            <Roles>SERVICE_GROUP_ADMIN</Roles>
            <EnabledActions>
                <Actions>ACtion_EDIT_OBJECT,ACTION_GRANT_ROLE, ACTION_REJECT_ROLE, ACTION_REVOKE_ROLE</Actions>
                <Target>SERviceGroup</Target> 
            </EnabledActions>
        </RoleMapping>

        <!-- 
        For the newly proposed edit NGI cert status: 
        <RoleMapping> 
           <Roles>
               COD_STAFF,
               COD_ADMIN,
               EGI_CSIRT_OFFICER,
               COO
           </Roles>  
           <EnabledActions> 
             <Actions>ACTION_NGI_EDIT_CERT_STATUS</Actions> 
             <Target>Ngi</Target>   
           </EnabledActions> 
        </RoleMapping> 
        -->
 
    </RoleActionMapping> 

</RoleActionMappingRules>
